"0",""
"0","county_name_national_averages <- (read_xlsx(""./data/county_profiles_raw.xlsx"", "
"0","                         sheet = 1) %>%"
"0","                    names())[1] %>%"
"0","    {str_replace_all(., "" County- Education Profile"", """")}"
"2","New names:"
"0","national_averages <- read_xlsx(""./data/county_profiles_raw.xlsx"", "
"0","                  sheet = 1, skip = 14) %>%"
"0","  slice(1:26) %>%  "
"0","  setNames("
"0","    c(""indicator"", "
"0","  ""preprimary_ece_female"", "
"0","  ""preprimary_ece_male"", "
"0","  ""preprimary_ece_total"", "
"0","  ""primary_female"", "
"0","  ""primary_male"", "
"0","  ""primary_total"", "
"0","  ""secondary_female"", "
"0","  ""secondary_male"", "
"0","  ""secondary_total"", "
"0","  ""national_average"")"
"0","  ) %>% "
"0","  select(indicator, national_average) %>% "
"0","  fill(indicator) %>% "
"0","  naniar::replace_with_na(list(national_average = ""NA"")) %>% "
"0","  filter(!is.na(national_average)) %>% "
"0","  mutate_at(vars(indicator), ~ str_trim(str_squish(.))) %>% "
"0","  mutate_at(vars(indicator), "
"0","            ~ gsub(""\\[.*?\\]"", """", .)) %>% "
"0","  mutate(national_average = str_replace_all(national_average, ""\\(|\\)"", """")) %>% "
"0","  mutate(value_temp = national_average) %>% "
"0","  separate_rows(national_average, sep = "","") %>% "
"0","  filter(national_average != """") %>% "
"0","  mutate(age_modifier = case_when(str_detect(national_average, ""PP"") ~ ""preprimary_ece"","
"0","                                  str_detect(national_average, ""P"") ~ ""primary"", "
"0","                                  str_detect(national_average, ""S:|S.:"") ~ ""secondary"","
"0","                                  str_detect(indicator, ""Transition Rate"") ~ ""secondary"", "
"0","                                  TRUE ~ NA_character_), "
"0","          sex_modifier = case_when(str_detect(national_average, ""B:"") ~ ""male"", "
"0","                                   str_detect(national_average, ""G:"") ~ ""female"", "
"0","                                   str_detect(national_average, ""T:"") ~ ""total"", "
"0","                                   TRUE ~ NA_character_)) %>% "
"0","  mutate(value_temp = str_sub(str_remove_all(value_temp, "",""), start = 5L), "
"0","         value = case_when(indicator == ""Number of education Institutions (Public & Private)"" & "
"0","                             !is.na(age_modifier) ~ parse_number(value_temp), "
"0","                           national_average == ""PP.: B: 111.5"" ~ 111.5, "
"0","                           national_average == ""PP.: B: 40"" ~ 40, "
"0","                           TRUE ~ parse_number(national_average))) %>% "
"0","  filter(value %out% c(652, 464, 390)) %>% "
"0","  fill(age_modifier) %>% "
"0","  select(-national_average, -value_temp) %>% "
"0","  rbind("
"0","    read_xlsx(""./data/county_profiles_raw.xlsx"", "
"0","                    sheet = 1, skip = 7) %>% "
"0","    slice(4) %>%"
"0","    clean_names() %>% "
"0","    rename(indicator = child_protection_indicator_4, "
"0","           value = percentage) %>% "
"0","    select(where(not_all_na)) %>% "
"0","    mutate(sex_modifier = ""female"", "
"0","           age_modifier = ""total"", "
"0","           indicator = str_remove(indicator, "
"0","                                  paste0("" in "", county_name_national_averages, "" County"")), "
"0","             value = as.numeric(value))"
"0","  ) %>% "
"0","  mutate(county = ""national"")"
"2","New names:"
"2","Warning: [38;5;238mThere was 1 warning in `mutate()`.[39m
[38;5;238m[36mi[38;5;238m In argument: `value = case_when(...)`.[39m
Caused by warning:
[33m![39m 5 parsing failures.
row col expected        actual
  1  -- a number PP.: 46      
  3  -- a number P.:  31      
  5  -- a number S.:  10      
  7  -- a number PP.: B: 111.5
 28  -- a number PP.: B: 40   "
"2","New names:"
