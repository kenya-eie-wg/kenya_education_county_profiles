"0","population_sort_order <- counties %>%"
"0","  filter(indicator %in% c(""county_population"", ""school_age_children"") & "
"0","           sex_modifier == ""total"") %>% "
"0","  pivot_wider(names_from = indicator, "
"0","              values_from = value) %>% "
"0","  mutate(pc = school_age_children / county_population * 100) %>% "
"0","  arrange(desc(school_age_children)) %>% "
"0","  pull(county)"
"0",""
"0",""
"0","counties %>%"
"0","  filter(indicator %in% c(""county_population"", ""school_age_children"") & "
"0","           sex_modifier == ""total"") %>% "
"0","  pivot_wider(names_from = indicator, "
"0","              values_from = value) %>% "
"0","  mutate(pc = school_age_children / county_population * 100) %>% "
"0","  ggplot(aes(x = school_age_children, y = fct_rev(fct_relevel(county, population_sort_order)), fill = pc)) + "
"0","  geom_col() + "
"0","  geom_text(aes(label = comma(school_age_children)), "
"0","            colour = ""grey20"", "
"0","            size = 4, "
"0","            hjust = ""inward"") +"
"0","  scale_fill_viridis(begin = .3, direction = -1) + "
"0","  scale_x_continuous(labels = comma) + "
"0","  labs(x = ""School-aged children"", "
"0","       y = """", "
"0","       fill = ""% of county\npopulation"", "
"0","       title = ""Number of school-aged children"") + "
"0","  theme(legend.title = element_text(size = 8))"
